{% extends "base.html" %}

{% block title %}Coach View - {{ user.name }}{% endblock %}

{% block content %}
<div class="coach-view">
    <div class="coach-header">
        <h1>Coach View: {{ user.name }}</h1>
        <p class="subtitle">Read-only access to workout data</p>
    </div>

    <div class="grid">
        <!-- Weekly Volume -->
        <div class="card">
            <h2>This Week's Volume</h2>
            {% if weekly_volume %}
            <table class="stats-table">
                <thead>
                    <tr>
                        <th>Exercise</th>
                        <th>Volume</th>
                        <th>Sets</th>
                        <th>Reps</th>
                    </tr>
                </thead>
                <tbody>
                    {% for exercise, stats in weekly_volume.items() %}
                    <tr>
                        <td>{{ exercise }}</td>
                        <td>{{ stats.total_volume }} kg</td>
                        <td>{{ stats.total_sets }}</td>
                        <td>{{ stats.total_reps }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="no-data">No workouts logged this week.</p>
            {% endif %}
        </div>

        <!-- Estimated 1RM -->
        <div class="card">
            <h2>Best Estimated 1RM (4 weeks)</h2>
            {% if best_1rms %}
            <table class="stats-table">
                <thead>
                    <tr>
                        <th>Exercise</th>
                        <th>Est. 1RM</th>
                    </tr>
                </thead>
                <tbody>
                    {% for exercise, one_rm in best_1rms.items() %}
                    <tr>
                        <td>{{ exercise }}</td>
                        <td>{{ one_rm }} kg</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="no-data">No data available yet.</p>
            {% endif %}
        </div>

        <!-- Recent Workouts -->
        <div class="card full-width">
            <h2>Recent Workouts</h2>
            {% if recent_workouts %}
            <div class="workout-history-list">
                {% for workout in recent_workouts %}
                <div class="workout-history-card">
                    <a href="{{ url_for('coach.view_workout', token=user.share_token, workout_id=workout.id) }}">
                        <div class="workout-history-header">
                            <h3>{{ workout.workout_name }}</h3>
                            <span class="date">{{ workout.date.strftime('%B %d, %Y') }}</span>
                        </div>
                        <div class="workout-history-meta">
                            <span class="badge">Split {{ workout.split }}</span>
                            <span class="badge">Week {{ workout.week_number }}</span>
                        </div>
                        {% if workout.notes %}
                        <div class="workout-history-notes">
                            {{ workout.notes[:100] }}{% if workout.notes|length > 100 %}...{% endif %}
                        </div>
                        {% endif %}
                    </a>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-data">No workouts logged yet.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
